\section{Proofs for Relationships with Other Schemes}
\label{app:related-proofs}

\subsection{Security of \CUASGS}

We prove that our \CUASGS construction is an anonymous, traceable, and
non-frameable group signature scheme, according to the model in \cite{bsz05}, if
the underlying \CUASGen construction is secure.

\begin{theorem}[Anonymity of \CUASGS]
  If the base \CUASGen construction has signature anonymity according to
  \defref{def:sign-anonymity-uas}, then \CUASGS is an anonymous group
  signature scheme.
\end{theorem}

\begin{proof}
  Assume an adversary \adv~ against anonymity in \CUASGS. This directly leads
  to an adversary \advB against anonymity of the $(\fissue^1,\feval^0,
  \finsp^{\upk})-\CUASGen$ instance.

  Concretely, observe that calls to \adv's \oracle{Ch}, \oracle{Open},
  \oracle{SndToU}, \oracle{WReg}, \oracle{USK}, \oracle{CrptU}
  oracles can be directly simulated by calls to \advB's oracles $\CHALb,
  \OPEN,\HUGEN,\OBTAIN,\WREG,\CUGEN,\UCORR$ oracles. Thus, if \adv~guesses its
  bit $b$ with non-negligible probability, this directly leads to a
  non-negligible probability of guessing \advB's challenge bit.
  \qed
\end{proof}

\begin{theorem}[Traceability of \CUASGS]
  If the base \CUASGen construction has signature unforgeability according to
  \defref{def:sign-forge-uas}, then \CUASGS is a traceable group signature
  scheme.
\end{theorem}

\begin{proof}
  Assume an adversary \adv~against traceability in \CUASGS. We build an
  adversary \advB against signature unforgeability of the $(\fissue^1,\feval^0,
  \finsp^{\upk})-\CUASGen$ restriction.

  \advB's simulation of \adv's environment is as in the proof for anonymity
  of \CUASGS (leveraging the \OBTISS and \ISSUE oracles, instead of \OBTAIN).
  \advB simply outputs whatever \adv~outputs in line 2 of its
  traceability game. Note that, whenever \CUASGS accepts a signature, so does
  \CUASGen. Concretely,
  assume that \adv~wins the traceability game in \figref{fig:model-gs} with
  $\upk \notin \HU \cup \CU$ at line 5. This implies that, in line 10 of the
  \UAS signature unforgeability game (\figref{fig:exp-uas-unfor}) $\OWNR[\lbrace
  \cid_i\rbrace_{i\in[n]}]$ returns an \uid which is not in either \HU or \CU.
  Similarly, if \adv~wins the traceability game with condition $\Judge(\dots)=0$
  at line 5, then \advB wins its signature unforgeability game with the
  corresponding check at line 11 in \figref{fig:exp-uas-unfor}.
  %
  \qed
\end{proof}

\begin{theorem}[Non-frameability of \CUASGS]
  If the base \CUASGen construction is non-frameable according to
  \defref{def:frame-uas}, then \CUASGS is a non-frameable group signature
  scheme.
\end{theorem}

\begin{proof}
  Assume an adversary \adv~against non-frameability in \CUASGS. We build an
  adversary \advB against non-frameability of the $(\fissue^1,\feval^0,
  \finsp^{\upk})-\CUASGen$ instance.
  
  \advB's simulation of \adv's~environment is as in the proof for anonymity
  of \CUASGS. \advB simply outputs whatever \adv~outputs at line 2 of its
  game. Observe that the winning condition for \adv~directly implies a winning
  condition for \advB. Concretely, if \adv~wins its game, \advB wins its game
  in line 11 of \ExpNonframe.
  \qed
\end{proof}

\subsection{Security of \CUASRing}

We prove that our \CUASRing construction is anonymous and unforgeable, in the
model given in \cite{bkm06}, if the underlying $\CUASGen^{hide-iss}$
construction is secure.

\begin{theorem}[Anonymity of \CUASRing]
  If the base $\CUASGen^{hide-iss}$ construction is anonymous according to
  \defref{def:sign-anonymity-uas}, then \CUASRing is an anonymous ring signature
  scheme.
\end{theorem}

\begin{proof}
  Assume \adv~is an adversary against anonymity for \CUASRing.
  Then, we build \advB against anonymity of \CUASGen. Concretely, \advB first
  generates $n$ key pairs for \adv~ simulating $KeyGen$ in \adv's game. Since
  $KeyGen$ simply uses algorithms of $\CUASGen^{hide-iss}$, \advB can do this
  directly via its own \HUGEN, \ISET, and \OGEN oracles, specifying
  $\fissue^{\sring}$ as issuance function, and $\finsp^0$ as opening function.
  Then, \advB invokes $\adv$ passing the $n$ produced public keys, and answers
  \adv's \oracle{SIGN}(i,R,\msg) queries as follows. If user $i$ has not yet
  produced a credential for ring $R$, where $\pk_i \in R$, \advB makes a call to
  its \OBTAIN oracle, using $R$ as attribute set. If such a credential was already
  produced, \advB simply reuses it. Then, \advB uses the corresponding user and
  credential identifiers as parameters to a query to its own \SIGN oracle
  (specifying $\feval^{\attrs}$ as signature evaluation function). Eventually,
  $\adv$ outputs two user indexes, a ring $R$, and message \msg. If the checks
  at lines 3-4 of \figref{fig:model-rs} pass, \advB generates the challenge
  signature by calling its own \CHALb oracle, and passes the result to $\adv$.
  Finally, \advB outputs whatever $\adv$ outputs.
  %
  The simulation of \adv's anonymity game is perfect, and \advB wins its game
  whenever \adv~ does.
  \qed
\end{proof}

\begin{theorem}[Unforgeability of \CUASRing]
  If the base $\CUASGen^{hide-iss}$ construction is non-frameable according to
  \defref{def:frame-uas}, then \CUASRing is an unforgeable ring signature
  scheme.
\end{theorem}

\begin{proof}
  Assume $\adv$ against unforgeability of \CUASRing wins the game. We build
  \advB winning the non-frameability game of \CUASGen with the same probability.
  %
  \advB prepares the environment as the adversary \advB against anonymity, and
  answers \adv's queries to the \oracle{SIGN} oracle also as in the anonymity
  proof. To answer \adv's queries to its \oracle{CORR} oracle, \advB leverages
  the \ICORR oracle in the non-frameability game for \UAS. Finally, \advB
  outputs whatever $\adv$ outputs.

  Note that, if $\adv$ wins its game, it means that the public keys of the
  issuers in $R$ all belong to uncorrupted users. Since the signature is
  accepted by $Verify$ at line 3 of the ring signature unforgeability game,
  it is also accepted by \Verify in the \UAS non-frameability game. But,
  moreover, given the construction of $Verify$ in \CUASRing, there is some
  honest \usk within $R$ that produced the signature, so $\OWNR[\scid] \in \HU$
  in \advB's non-frameability game. Also, since $\adv$ never queried its
  \oracle{SIGN} oracle, then by construction there cannot exist a matching entry
  in \advB's $\SIG[\uid]$ table. Thus, \advB wins the non-frameability game
  whenever $\adv$ wins its unforgeability game. Since \CUASGen is non-frameable,
  then this probability must be negligible.
  %
  \qed
\end{proof}

\subsection{Security of \CUASAC}

We prove that \CUASAC is an anonymous and unforgeable anonymous credential
scheme, according to \cite{fhs19}, if the underlying \CUASGen construction
is anonymous and unforgeable. Note that AC schemes modelled as in \cite{fhs19}
do not have issuance anonymity, as the user public key is passed to the issuer.
For ease of reference to the games in \secref{sec:formal-uas}, we
reduce to security of \CUASGen rather than to $\CUASGen^{int}$. The
``translation'' between \CUASGen and $\CUASGen^{int}$ is trivial, though.

\begin{theorem}[Anonymity of \CUASAC]
  \label{thm:anon-cuasac}
  If the base \CUASGen construction has signature anonymity according to
  \defref{def:sign-anonymity-uas}, then \CUASAC is an anonymous AC scheme
  according to \cite{fhs19}.
\end{theorem}

\begin{proof}
  Given \adv~against anonymity of \CUASAC as defined in \cite{fhs19}, we build
  an adversary \advB against signature anonymity of \CUASGen as defined
  in \defref{def:sign-anonymity-uas}.

  To simulate oracle calls by \adv, \advB simply redirects to its corresponding
  oracle, i.e.: for calls to \oracle{HU}, \oracle{CU}, \oracle{Obtain},
  \oracle{Show}, \oracle{LoR}, \advB redirects to
  \HUGEN, \CUGEN, \OBTAIN, \SIGN, \CHALb, respectively. Note that translating
  the inputs from the former into inputs for the latter is trivial.
  Obviously, if \adv~wins in its anonymity game, then so does \advB with the
  same probability.
  % 
  \qed
\end{proof}

\begin{theorem}[Unforgeability of \CUASAC]
  \label{thm:forge-cuasac}
  If the base \CUASGen construction has signature unforgeability according to
  \defref{def:sign-forge-uas}, then \CUASAC is an unforgeable AC scheme.
\end{theorem}

\begin{proof}
  Given \adv~against unforgeability of \CUASAC as defined in \cite{fhs19}, we
  build an adversary \advB against signature unforgeability of \CUASGen as
  defined in \defref{def:sign-forge-uas}.

  To simulate oracle calls by \adv, \advB acts as in the anonymity proof
  ($ObtIss$ and $Issue$ for \adv~correspond to \OBTISS and \ISSUE for \advB).
  Assume that \adv~wins its game. Note that, since $b=1$ in line 4 of the
  unforgeability game of \figref{fig:model-ac}, then by construction, \Verify
  also returns $1$ in the signature unforgeability game of \UAS. In addition, if
  there is no corrupt user with a credential containing $D$, then this leads to
  \advB winning at line 12 in \figref{fig:exp-uas-unfor}, as no credential
  owned by a corrupt user that can be extracted can make the $\feval^{\dattrs}$
  function output $\yeval^0=D$. Thus, \advB wins with the same probability as
  \adv~does.  
  %
  \qed
\end{proof}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "uas-paper"
%%% End:
