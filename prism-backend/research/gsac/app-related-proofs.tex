\section{Proofs for Relationships with Other Schemes}
\label{app:related-proofs}

\subsection{Security of \CUASGS}

We prove that our \CUASGS construction is a secure group signature scheme,
according to \cite{bsz05}, if the underlying \CUASGen construction is secure.

\begin{theorem}[Anonymity of \CUASGS]
  If the base \CUASGen construction has signature anonymity according to
  \defref{def:sign-anonymity-uas}, then \CUASGS is an anonymous group
  signature scheme.
\end{theorem}

\begin{proof}
  Assume an adversary \adv~ against anonymity in \CUASGS. This directly leads
  to an adverary \advB against anonymity of the $(\fissue^1,\feval^0,
  \finsp^{\upk})-\CUASGen$ instance.

  Concretely, observe that calls to \adv's $Ch,Open,SndToU,WReg,USK,CrptU$
  oracles can be directly simulated by calls to \advB's oracles $\CHALb,
  \OPEN,\HUGEN,\WREG,\CUGEN,\UCORR$ oracles. Thus, if \adv~guesses its bit $b$
  with non-negligible probability, this directly leads to a non-negligible
  probability of guessing \advB's challenge bit.
  \qed
\end{proof}

\begin{theorem}[Traceability of \CUASGS]
  If the base \CUASGen construction is unforgeable according to
  \defref{def:forge-uas}, then \CUASGS is a traceable group signature
  scheme.
\end{theorem}

\begin{proof}
  Assume an adversary \adv~against traceability in \CUASGS. We build an
  adversary \advB against unforgeability of the $(\fissue^1,\feval^0,
  \finsp^{\upk})-\CUASGen$ restriction.

  \advB's simulation of \adv's environment is as in the proof for anonymity
  of \CUASGS. \advB simply outputs whatever \adv~outputs in line 2 of its
  traceability game. Note that, whenever \CUASGS accepts a signature, so does
  \CUASGen. Concretely,
  assume that \adv~wins the traceability game in \figref{fig:model-gs} with
  $\upk \notin \HU \cup \CU$ at line 5. This implies that, in line 14 of the
  \UAS unforgeability game (\figref{fig:exp-uas-unfor}) $\OWNR[\lbrace \cid_i
  \rbrace_{i\in[n]}]$ returns an \uid which is not in either \HU or \CU.
  Similarly, if \adv~wins the traceability game with condition $\Judge(\dots)=0$
  at line 5, then \advB wins its unforgeability game with the corresponding
  check at line 6 in \figref{fig:exp-uas-unfor}.
  %
  \qed
\end{proof}

\begin{theorem}[Non-frameability of \CUASGS]
  If the base \CUASGen construction is non-frameable according to
  \defref{def:frame-uas}, then \CUASGS is a non-frameable group signature
  scheme.
\end{theorem}

\begin{proof}
  Assume an adversary \adv~against non-frameability in \CUASGS. We build an
  adversary \advB against non-frameability of the $(\fissue^1,\feval^0,
  \finsp^{\upk})-\CUASGen$ instance.
  
  \advB's simulation of \adv's~environment is as in the proof for anonymity
  of \CUASGS. \advB simply outputs whatever \adv~outputs at line 2 of its
  game. Observe that the winning condition for \adv~directly implies a winning
  condition for \advB. Concretely, if \adv~wins its game, \advB wins its game
  in line 11 of \ExpNonframe.
  \qed
\end{proof}

\subsection{Security of \CUASRing}

We prove that our \CUASRing construction is anonymous and unforgeable, if
the underlying $\CUASGen^{hide-iss}$ construction is secure.

\begin{theorem}[Anonymity of \CUASRing]
  If the base $\CUASGen^{hide-iss}$ construction is anonymous according to
  \defref{def:sign-anonymity-uas}, then \CUASRing is an anonymous ring signature
  scheme.
\end{theorem}

\begin{proof}
  Assume $\adv$ is an adversary against ring signature anonymity for \CUASRing.
  Then, we build \advB against anonymity of \CUASGen. Concretely, \advB first
  generates $n$ key pairs for \adv simulating $KeyGen$ in \adv's game. Since
  $KeyGen$ simply uses algorithms of $\CUASGen^{hide-iss}$, \advB can do this
  directly via its own \HUGEN, \ISET, and \OGEN oracles, specifying
  $\fissue^{\sring}$ as issuance function, and $\finsp^0$ as opening function.
  Then, \advB invokes $\adv$ passing the $n$ produced public keys, and
  answers $\adv$'s $SIGN(i,R,\msg)$ queries as follows. If user $i$ has not yet
  produced a credential for ring $R$, where $\pk_i \in R$, \advB makes a call to
  its \OBTAIN oracle, using $R$ as attribute set. If such a credential was already
  produced, \advB simply reuses it. Then, \advB uses the corresponding user and
  credential identifiers as parameters to a query to its own \SIGN oracle
  (specifying $\feval^{\attrs}$ as signature evaluation function). Eventually,
  $\adv$ outputs two user indexes, a ring $R$, and message \msg. If the checks
  at lines 3-4 of \figref{fig:model-rs} pass, \advB generates the challenge
  signature by calling its own \CHALb oracle, and passes the result to $\adv$.
  Finally, \advB outputs whatever $\adv$ outputs.
  %
  The simulation of \adv's anonymity game is perfect, and \advB wins its game
  whenever \adv does.
  \qed
\end{proof}

\begin{theorem}[Unforgeability of \CUASRing]
  If the base $\CUASGen^{hide-iss}$ construction is non-frameable according to
  \defref{def:frame-uas}, then \CUASRing is an unforgeable ring signature
  scheme.
\end{theorem}

\begin{proof}
  Assume $\adv$ against unforgeability of \CUASRing wins the game. We build
  \advB winning the non-frameability game of \CUASGen with the same probability.
  %
  \advB prepares the environment as the adversary \advB against anonymity,
  and answers \adv's queries to the $SIGN$ oracle also as in the anonymity
  proof. To answer \adv's queries to its $CORR$ oracle, \advB leverages the
  \ICORR oracle in the non-frameability game for \UAS. Finally, \advB outputs
  whatever $\adv$ outputs.

  Note that, if $\adv$ wins its game, it means that the public keys of the
  issuers in $R$ all belong to uncorrupted users. Since the signature is
  accepted by $Verify$ at line 3 of the ring signature unforgeability game,
  it is also accepted by \Verify in the \UAS non-frameability game. But,
  moreover, given the construction of $Verify$ in \CUASRing, there is some
  honest \usk within $R$ that produced the signature, so $\OWNR[\scid] \in \HU$
  in \advB's non-frameability game. Also, since $\adv$ never queried its $SIGN$
  oracle, then by construction there cannot exist a matching entry in \advB's
  $\SIG[\uid]$ table. Thus, \advB wins the non-frameability game whenever
  $\adv$ wins its unforgeability game. Since \CUASGen is non-frameable, then
  this probability must be negligible.
  %
  \qed
\end{proof}

\subsection{Security of \CUASAC}

We prove that \CUASAC is an anonymous and unforgeable anonymous credential
scheme, according to \cite{fhs19}, if the underlying \CUASGen construction
is anonymous and unforgeable. Note that AC schemes modelled as in \cite{fhs19}
do not have issuance anonymity, as the user public key is passed to the issuer.

\begin{theorem}[Anonymity of \CUASAC]
  \label{thm:anon-cuasac}
  If the base \CUASGen construction is anonymous according to
  \defref{def:anonymity-uas}, then \CUASAC is an anonymous AC scheme according
  to \cite{fhs19}.
\end{theorem}

\begin{proof}
  Given \adv~against anonymity of \CUASAC as defined in \cite{fhs19}, we build
  an adversary \advB against anonymity of \CUASGen as defined in
  \defref{def:sign-anonymity-uas}.

  To simulate oracle calls by \adv, \advB simply redirects to its corresponding
  oracle, i.e.: for calls to $HU,CU,Obtain,Show,LoR$, \advB redirects to
  \HUGEN,\CUGEN,\OBTAIN,\SIGN,\CHALb, respectively. Note that ``translating''
  the inputs from the former into inputs for the latter is trivial.
  Obviously, if \adv~wins in its anonymity game, then so does \advB with the
  same probability.
  % 
  \qed
\end{proof}

\begin{theorem}[Unforgeability of \CUASAC]
  \label{thm:forge-cuasac}
  If the base \CUASGen construction is unforgeable according to
  \defref{def:forge-uas}, then \CUASAC is an unforgeable AC scheme.
\end{theorem}

\begin{proof}
  Given \adv~against unforgeability of \CUASAC as defined in \cite{fhs19}, we
  build an adversary \advB against unforgeability of \CUASGen as defined in
  \defref{def:forge-uas}.

  To simulate oracle calls by \adv, \advB acts as in the anonymity proof
  ($ObtIss$ and $Issue$ for \adv~correspond to \OBTISS and \ISSUE for \advB).
  Assume that \adv~wins its game. Note that, since $b=1$ in line 4 of the
  unforgeability game of \figref{fig:model-ac}, then by construction, \Verify
  also returns $1$ in the unforgeability game of \UAS. In addition, if
  there is no corrupt user with a credential containing $D$, then this leads to
  \advB winning at line 12 in \figref{fig:exp-uas-unfor}, as no credential
  owned by a corrupt user that can be extracted can make the $\feval^{\dattrs}$
  function output $\yeval^0=D$. Thus, \advB wins with the same probability as
  \adv~does.  
  %
  \qed
\end{proof}

\subsection{Security of \CUASRAC}

We prove that \CUASRAC is an anonymous and unforgeable anonymous credential
scheme, according to \cite{fhs19}, if the underlying \CUASGen construction
has signature anonymity and is unforgeable.

\begin{theorem}[Anonymity of \CUASRAC]
  \label{thm:anon-cuasrac}
  If the base \CUASGen construction has signature anonymity according to
  \defref{def:sign-anonymity-uas}, and $F$ is one-way, then \CUASAC is an
  anonymous AC scheme according to \cite{fhs19}.
\end{theorem}

\begin{proof}
  Given \adv~ against anonymity of \CUASRAC as defined in
  \figref{fig:model-rac}, we build an adversary \advB against anonymity of
  \CUASGen as defined in \defref{def:sign-anonymity-uas}.

  First observe that, given a revocation handles $F(V,\cidi)$ and $F(V,\cidu)$
  extracted from any credential showing, it is not possible to extract $\cidi$
  nor $\cidu$, as $F$ is one-way.
  
  To simulate oracle calls by \adv, \advB simply redirects to its corresponding
  oracle, i.e.: for calls to $HU,CU,Obtain,Show,LoR,ReqCredHandle$, \advB
  redirects to \HUGEN, \CUGEN, \OBTAIN, \SIGN, \CHALb, or \OPEN, respectively.
  Note that ``translating'' the inputs from the former into inputs for the
  latter is trivial. Also, observe that $ReqCredHandle$/\OPEN essentially
  refuses to open transcripts from challenge users (signatures, in the
  non-interactive equivalent), as $F(V,\ccidi_0) \neq F(V,\ccidi_1)$ (and,
  similarly, for $\ccidu_b$) with overwhelming probability (see the $\tyinsp
  \neq \yinsp$) check in \figref{fig:oracles2}. Obviously, if \adv~wins in its
  anonymity game, then so does \advB with the same probability.
  % 
  \qed
\end{proof}

\begin{theorem}[Unforgeability of \CUASRAC]
  If the base \CUASGen construction has unforgeability according to
  \defref{def:forge-uas}, and $F$ is one-way, then
  \CUASRAC is an unforgeable RAC scheme.
\end{theorem}

\begin{proof}
  Given \adv~against unforgeability of \CUASRAC as defined in
  \figref{fig:model-rac}, we build an adversary \advB against unforgeability of
  \CUASGen as defined in \defref{def:forge-uas}.

  To simulate oracle calls by \adv, \advB acts as in the anonymity proof. Assume
  that \adv~wins its game via the winning condition of line 7 in the RAC
  unforgeability game. The same reasoning as in \CUASAC applies here. Next, note
  that the probability of \adv~winning its game via the winning condition at
  line 9 is negligible, due to soundness of the NIZK scheme used for signing,
  and the one-wayness of $F$ in $\feval^{\dattrs,F,V,L}$ and $\finsp^{F}$.
  % 
  \qed
\end{proof}

\subsection{Security of \CUASMPS}

As stated, we restrict to privacy-1 of MPS (although, as discussed, we actually
achieve something slightly stronger). Unforgeability-1 in MPS is
implied by unforgeability in \UAS (where the latter also covers unforgeability
of \fissue evaluations, plus verifiable openings). Unforgeability-2 in MPS is
equivalent to non-frameability in \UAS (where the latter also includes
framing via verifiable openings). Finally note that, in UAS, we do not
explicitly model extractability, but rather make it an inherent requirement in
the unforgeability and non-frameability definitions. Thus, our \CUASMPS
construction also ensures MPS-extractability.

\begin{theorem}[Privacy-1 of \CUASMPS]
  If the base \CUASGen construction has signature anonymity according to
  \defref{def:sign-anonymity-uas}, then \CUASMPS satisfies privacy-1
  according to \cite{ngsy22}.
\end{theorem}

\begin{proof}  
  Note that the privacy-1 game in MPS and the signature anonymity game in \UAS
  are, in essence, equivalent. Thus, given an adversary \adv~that breaks
  privacy-1 of \CUASMPS as defined for MPS, it is easy to build an adversary
  \advB breaking signature anonymity of the underlying \CUASGen, as defined in
  \UAS.

  \advB simply leverages its own oracles in order to answer oracle queries from
  \adv: $\mathcal{O}_{read},\mathcal{O}_{write},\mathcal{O}_{CU},\mathcal{O}_{HU},
  \mathcal{O}_{sig},\mathcal{O}_{open}$ in MPS correspond to \RREG, \WREG,
  \CUGEN, \HUGEN, \SIGN and \OPEN in \UAS, respectively. The output given by
  \adv~in the first stage of the MPS game is then directly used as input to
  \advB's \CHALb oracle. Finally, \advB outputs whatever \adv~outputs.

  Since the simulation is direct, it is easy to see that, whenever \adv~wins,
  so does \advB.
  % 
  \qed
\end{proof}

\begin{theorem}[Extractability of \CUASMPS]
  If the base \CUASGen construction has non-frameability according to
  \defref{def:frame-uas}, then \CUASMPS is an extractable MPS scheme.
\end{theorem}

\begin{proof}  
  The proof is direct, as the winning conditions in the extractability
  experiment in MPS are also winning conditions in the non-frameability
  experiment for \UAS. That is, an adversary \adv~against extractability of
  \CUASMPS, as defined in MPS, can be used to build an adversary \advB breaking
  non-frameability of \CUASGen, as defined in the \UAS model.

  \advB simulates \adv's game essentially as in the privacy-1 proof. Note also
  that \adv~receives the issuer's secret key. This can be obtained by \advB via
  its \ICORR oracle. Eventually, \adv~outputs a $(F,M,\Sigma)$ tuple, which
  corresponds to $(\feval^{g,MPS},\msg,\Sig)$ (with $g=F$ in MPS) in \CUASGen,
  which \advB outputs in its own game. In addition, \advB outputs as $(\yinsp,
  \pi)$ values the output of \Open over $(\Sig,\msg)$ -- which internally
  computes $\finsp^{h,MPS}$, for $h=G$ in MPS.
  % 
  Note that the $\feval^{g,MPS}$ and $\finsp^{h,MPS}$ functions in \CUASMPS
  mimic the behaviour of MPS's $F$ and $G$, respectively. Thus, if \adv wins
  because $F$ returns $0$ when evaluated on the extracted values, then \advB
  wins at line 7 of the non-frameability game, as a legitimately computed
  $\feval^{g,MSP}$ function cannot output $0$. Similarly, if \adv~wins because
  the value returned by an honestly computed open function over the adversarial
  $(F,M,\Sigma)$ tuple does not match the output of $G$ over the extracted
  values, \advB wins at line 9: note that \advB returns the \yinsp value that
  \Open outputs (when computed honestly over \adv's output), whereas
  $\finsp^{g,MSP}=G$; thus, if both values differ in \adv's game, then they also
  differ in \advB's game.
  %
  \qed
\end{proof}

\begin{theorem}[Unforgeability-1 of \CUASMPS]
  If the base \CUASGen construction is unforgeable according to
  \defref{def:forge-uas}, then \CUASMPS satisfies unforgeability-1 as defined in
  \cite{ngsy22}.
\end{theorem}

\begin{proof}
  Given an adversary \adv~against unforgeability-1 of \CUASMPS, as defined in
  the MPS model, we build \advB that breaks unforgeability of the underyling
  \CUASGen, as defined for \UAS.

  Simulation of \adv's oracles by \advB is again direct (as in previous proofs).
  Now, suppose that \adv~wins -- i.e., the identity extracted by \adv~does not
  belong to the set of corrupt users in \adv's game. By construction of \advB
  (identities in \adv's game map to a $\cid$ for \advB), $\OWNR[\cid] \notin
  \CU$ in \advB's unforgeability game either.
  % 
  However, in order for \advB to win in its own game, we need to prove also that
  the produced identity does not belong to a user in \HU either. Suppose that it
  does. Simulation extractability ensures that the credentials extracted by
  \adv~all belong to the same user (by assumption, in \HU) -- i.e., they are
  bound to its \usk. Moreover, since \adv~wins its game, the signature output by
  \adv~has not been obtained via its \SIGN oracle. But, given that the user is
  honest, its \usk has been produced uniformly at random, and has not been
  leaked to \adv~(as the issuer is also honest). Thus, the probability that
  the extracted credentials belong to an honest user is negligible and, if
  \adv~wins its game, \advB also does.
  %
  \qed
\end{proof}

\begin{theorem}[Unforgeability-2 of \CUASMPS]
  If the base \CUASGen construction has non-frameability according to
  \defref{def:frame-uas}, then \CUASMPS satisfies unforgeability-2 as
  defined in \cite{ngsy22}.
\end{theorem}

\begin{proof}
  Given an adversary \adv~against unforgeability-2 of \CUASMPS, as defined in
  the MPS model, we build \advB that breaks non-frameability of the underyling
  \CUASGen, as defined for \UAS.

  Simulation of \adv's oracles by \advB is as in the unforgeability-1 proof.
  \advB outputs whatever \adv~outputs, adding a $(\yinsp,\iproof)$ pair, honestly
  generated from \adv's output. Note that the winning condition of \adv~
  requires that the produced signature belongs to an honest user, without
  having been produced via a call to the signing oracle. By construction of
  \advB, this directly makes \advB win in line 11 of the non-frameability game.
  %
  \qed
\end{proof}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "uas-paper"
%%% End:
