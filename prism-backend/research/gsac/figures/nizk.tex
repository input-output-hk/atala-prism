\begin{tikzpicture}

  %% Issue
  \node (issue) at (-9.00,8.875) { $\RelIss = $ };
  \node (issue2) at (-3.40,9.50) {
    $(\upk,\usk,\lbrace (\cid_i,\cattrs_i,\cred_i)\rbrace_{i \in [n]},r),
    (\Ccom,\cid,\attrs,\ipk,\lbrace \ipk_i \rbrace_{i\in[n]},\yissue):$
  };
  \node[align=center] (issue3) at (-3.40,8.625) {
%    $\upk = \CCommit(\usk;0) \land \Ccom = \CCommit(\usk;r)~\land$ \\
    $(\upk,\usk) \gets \KeyGen(\parm;r)~\land$ \\
    $\Ccom = \SBCMBlind(\ipk,\usk,\lbrace \cid \rbrace \cup \attrs)~\land$ \\
    % \Ccom = \CCommit(\usk;r)~\land$ \\   
    $\fissue(\upk,\cid,\attrs,\lbrace(\cid_i,\cattrs_i)\rbrace_{i\in[n]}) = \yissue~
    \land$ \\
    $\forall i \in [n], \SBCMVerify(\ipk_i,\cred_i,\usk,
    \lbrace \cid_i \rbrace \cup \cattrs_i) = 1$
  };
  \draw [thick,decorate,decoration={brace}] (-8.25,8.00) -- (-8.25,9.75);
  \draw [thick,decorate,decoration={brace}] (1.35,9.75) -- (1.35,8.00);

  %% Sign
  \node (sign) at (-6.40,6.625) { $\RelSig = $ };
  \node (sign2) at (0.00,7.50) {
    $(\upk,\usk,\lbrace(\cid_i,\attrs_i,\cred_i)\rbrace_{i\in[n]},\yeval^1,
    \yinsp,r,r'), (\msg,\feval,\yeval^0,\cinsp,\lbrace\ipk_i\rbrace,\Eek):$
  };
  \node[align=center] (sign3) at (0.00,6.35) {
%    $\upk = \CCommit(\usk;0) \land \cinsp = \EEnc (\Eek,\yinsp;r)~\land$ \\
    $(\upk,\usk) \gets \KeyGen(\parm;r) \land
    \cinsp = \EEnc (\Eek,\yinsp;r')~\land$ \\
    $(\yeval^0,\yeval^1) =
    \feval(\upk,\lbrace (\cid_i,\attrs_i) \rbrace_{i\in[n]},\msg)~\land$ \\ 
    $\yinsp = \finsp((\yeval^0,\yeval^1),\upk,
    \lbrace (\cid_i,\attrs_i) \rbrace_{i\in[n]},\msg)~\land$ \\
    $\forall i \in [n], \SBCMVerify(\ipk_i,\cred_i,\usk,
    \lbrace \cid_i \rbrace \cup \attrs_i) = 1$
  };
  \draw [thick,decorate,decoration={brace}] (-5.50,5.50) -- (-5.50,7.75);
  \draw [thick,decorate,decoration={brace}] (5.50,7.75) -- (5.50,5.50);

  %% Open
  \node (issue) at (2.35,8.875) { $\RelIns = $ };
  \node (issue2) at (4.65,9.125) {
    $(\osk),(\Ec,\yinsp):$
  };
  \node (issue3) at (4.65,8.625) {
    $\yinsp = \EDec(\osk,\Ec)$
  };  
  \draw [thick,decorate,decoration={brace}] (3.15,8.375) -- (3.15,9.375);
  \draw [thick,decorate,decoration={brace}] (6.15,9.375) -- (6.15,8.375);

  % \NIZKRel_{\Open} =
  % \lbrace (\osk),(\Ec,\yinsp):  \rbrace

\end{tikzpicture}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../uas-paper"
%%% End:
